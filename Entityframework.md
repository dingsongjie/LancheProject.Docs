#Lanche.Entityframework
EntityFramework?–???μ??DbContext?????????????????????????μ??UnitOfWork?1???€?-
???—???????¨?’?￥?’??????DbContext?￡?????￠?????“???·?¨?o???”?-?±???μ??ef?’?????￡?’???‘?1
```c#
 public  class TestDbContext : DbContext
    {
        public TestDbContext()
            : base("name=TestDbContext")
        {
        }

        public virtual DbSet<Students> Students { get; set; }

        protected override void OnModelCreating(DbModelBuilder modelBuilder)
        {

        }
    }
```
?????o?3 ???2?????????”???3?μ???????ˉ?–???—?￠???????1?“???????3???—?”DbContext?μ??ef???????????￠?·?????????”???3?￡???2?￠?—?￠???????¤?–???μ???????’??????DbSet,???a?·?￠?????”?±?–?????¨?”??Service?–???–?±???“???1?“?????′???‰
```c#
 public class TestApplicationService : ApplicationServiceBase
    {
        private readonly IEfRepository<Students> _studentRepository;      

        public TestApplicationService(IEfRepository<Students> studentRepository, IUnitOfWorkManager uowManger,ILogger logger)
        {
            _studentRepository = studentRepository;
           
        }
        
        public virtual PagingEntity<Students> GetInPaging(int pageIndex, int PageSize, bool sort, string orderProperty)
        {
           
          
            return _studentRepository.GetInPaging(m => m.IsDeleted == false, pageIndex, PageSize, orderProperty, sort);

        }
  }
```
?‰?????|?μ??StudentRepository???′?“???1?1?”???o?ˉ?????—?￠?????￡???μ?±????castle windsor ?’?2?????–?§?3?–???′???”?—?￠?????μ??
IEfRepository<>?????1???μ???·???·?¨???§????
##?2???‘?ˉ
```c#
 /// <summary>
        /// ?μ???μ?? IQueryable ,?’?”?????1??linq ?2???‘?ˉ???????|
        /// </summary>
        /// <returns></returns>
        IQueryable<TEntity> GetAll();

        /// <summary>
        /// ?·?μ???????1?“?????μ???￥List
        /// </summary>
        /// <returns>???μ???￥List</returns>
        List<TEntity> GetAllList();

        /// <summary>
        /// ?·?μ???????1?“?????μ???￥List
        /// </summary>
        /// <returns>???μ???￥List</returns>
        Task<List<TEntity>> GetAllListAsync();



        /// <summary>
        /// ???1???? lambda ?·?μ???? ???μ???￥List
        /// </summary>
        /// <param name="predicate">where ???μ????</param>
        /// <returns>???μ???￥ list</returns>
        List<TEntity> GetAllList(Expression<Func<TEntity, bool>> predicate);

        /// <summary>
        /// ???1???? lambda ?·?μ???? ???μ???￥List
        /// </summary>
        /// <param name="predicate">where ???μ????</param>
        /// <returns>???μ???￥ list</returns>
        Task<List<TEntity>> GetAllListAsync(Expression<Func<TEntity, bool>> predicate);
         /// <summary>
        /// è?”????‰€??‰?????“List????????…?-???-??“?-??????????????€?è·?è??
        /// </summary>
        /// <returns>?????“List</returns>
        List<TEntity> GetAllListNoTracking();
        /// <summary>
        /// è?”????‰€??‰?????“List????????…?-???-??“?-??????????????€?è·?è??????-￥?–1?3?
        /// </summary>
        /// <returns>?????“List</returns>
        Task<List<TEntity>> GetAllListNoTrackingAsync();
        /// <summary>
        /// ??1??? lambda è?”??? ?????“List ??????????€?è·?è??
        /// </summary>
        /// <param name="predicate">where ??????</param>
        /// <returns>?????“ list</returns>
        List<TEntity> GetAllListNoTracking(Expression<Func<TEntity, bool>> predicate);
        /// <summary>
        /// ??1??? lambda è?”??? ?????“List ??????????€?è·?è??????-￥
        /// </summary>
        /// <param name="predicate">where ??????</param>
        /// <returns>?????“ list</returns>
        Task<List<TEntity>> GetAllListNoTrackingAsync(Expression<Func<TEntity, bool>> predicate);
        /// <summary>
        /// ?·?μ?????μ?￥?????￡?????’?μ?????????? ?–?±???“?±?¨?′?-
        /// </summary>
        /// <param name="predicate">where ???μ????</param>
        /// <returns></returns>
        TEntity Single(Expression<Func<TEntity, bool>> predicate);
        /// <summary>
        /// ?·?μ?????μ?￥?????￡?????’?μ?????????? ?–?±???“?±?¨?′?-
        /// </summary>
        /// <param name="predicate">where ???μ????</param>
        /// <returns></returns>
        Task<TEntity> SingleAsync(Expression<Func<TEntity, bool>> predicate);


        /// <summary>
        /// ?μ???μ???μ???’??????
        /// </summary>
        /// <param name="predicate">where ???μ????</param>
        TEntity FirstOrDefault(Expression<Func<TEntity, bool>> predicate);
        /// <summary>
        /// ?μ???μ???μ???’??????
        /// </summary>
        /// <param name="predicate">where ???μ????</param>
        Task<TEntity> FirstOrDefaultAsync(Expression<Func<TEntity, bool>> predicate);
         /// <summary>
        /// è?”????????a????‰???°?¤??????′??￥??￥é”? ??????????€?è·?è??
        /// </summary>
        /// <param name="predicate">where ??????</param>
        /// <returns></returns>
        TEntity SingleNoTracking(Expression<Func<TEntity, bool>> predicate);
        /// <summary>
        /// è?”????????a????‰???°?¤??????′??￥??￥é”? ??????????€?è·?è??async
        /// </summary>
        /// <param name="predicate">where ??????</param>
        /// <returns></returns>
        Task<TEntity> SingleNoTrackingAsync(Expression<Func<TEntity, bool>> predicate);
        /// <summary>
        /// ??—??°?????€?????–è€?null  ??????????€?è·?è??
        /// </summary>
        /// <param name="predicate">where ??????</param>
        TEntity FirstOrDefaultNoTracking(Expression<Func<TEntity, bool>> predicate);
        /// <summary>
        /// ??—??°?????€?????–è€?null   ??????????€?è·?è??async
        /// </summary>
        /// <param name="predicate">where ??????</param>
        Task<TEntity> FirstOrDefaultNoTrackingAsync(Expression<Func<TEntity, bool>> predicate);

        /// <summary>
        /// ?·?–?’?3
        /// </summary>
        /// <param name="query">where</param>
        /// <param name="pageIndex">?μ?±???°?’?3</param>
        /// <param name="pageSize">?’?3size</param>
        /// <param name="orderPropertyName">order Property</param>
        /// <param name="sort"> ???????2???| </param>
        /// <returns>?°???o?????1?“???·?–?’?3???…???￠?μ???????????′???μ?????”???3</returns>
        PagingEntity<TEntity> GetInPaging(Expression<Func<TEntity, bool>> query, int pageIndex, int pageSize, string orderPropertyName, bool sort = true);

        /// <summary>
        /// ?·?–?’?3
        /// </summary>
        /// <param name="query">where</param>
        /// <param name="pageIndex">?μ?±???°?’?3</param>
        /// <param name="pageSize">?’?3size</param>
        /// <param name="orderPropertyName">order Property</param>
        /// <param name="sort"> ???????2???| </param>
        /// <returns>?°???o?????1?“???·?–?’?3???…???￠?μ???????????′???μ?????”???3</returns>
        Task<PagingEntity<TEntity>> GetInPagingAsync(Expression<Func<TEntity, bool>> query, int pageIndex, int pageSize, string orderPropertyName, bool sort = true);
         /// <summary>
        /// ???é?μ ??????????€?è·?è??
        /// </summary>
        /// <param name="query">where</param>
        /// <param name="pageIndex">??“?‰?é??/param>
        /// <param name="pageSize">é?μsize</param>
        /// <param name="orderPropertyName">order Property</param>
        /// <param name="sort"> ?-￡??–é€?</param>
        /// <returns>??…????‰€??‰???é?μ?????ˉ?????°??????é€’?ˉ1è±?/returns>
        PagingEntity<TEntity> GetInPagingNoTracking(Expression<Func<TEntity, bool>> query, int pageIndex, int pageSize, string orderPropertyName, bool sort = true);
        /// <summary>
        /// ???é?μ ??????????€?è·?è??async
        /// </summary>
        /// <param name="query">where</param>
        /// <param name="pageIndex">??“?‰?é??/param>
        /// <param name="pageSize">é?μsize</param>
        /// <param name="orderPropertyName">order Property</param>
        /// <param name="sort"> ?-￡??–é€?</param>
        /// <returns>??…????‰€??‰???é?μ?????ˉ?????°??????é€’?ˉ1è±?/returns>
        Task<PagingEntity<TEntity>> GetInPagingNoTrackingAsync(Expression<Func<TEntity, bool>> query, int pageIndex, int pageSize, string orderPropertyName, bool sort = true);

        /// <summary>
        /// ??—??°Database?ˉ1??‘ ??￥è?·??—ado.net è??é—???°????o“???é?¨???è?????
        /// </summary>
        /// <returns></returns>
        Database GetDatebase();
          int Count();

        Task<int> CountAsync();

        int Count(Expression<Func<TEntity, bool>> predicate);

        Task<int> CountAsync(Expression<Func<TEntity, bool>> predicate);

        /// <summary>
        /// ?μ?±?????????3???1?? 2^31-1
        /// </summary>
        /// <returns>Count of entities</returns>
        long LongCount();

        /// <summary>
        /// ?μ?±?????????3???1?? 2^31-1
        /// </summary>
        /// <returns>Count of entities</returns>
        Task<long> LongCountAsync();

        /// <summary>
        /// ?μ?±?????????3???1?? 2^31-1
        /// </summary>
        /// <returns>Count of entities</returns>
        long LongCount(Expression<Func<TEntity, bool>> predicate);

        Task<long> LongCountAsync(Expression<Func<TEntity, bool>> predicate);
```
##?????”??
```c#
 ///?????2?? ???-???“?μ?￥????
        TEntity Insert(TEntity entity);

        ///?’???2?? ???-???“?μ?￥????
        Task<TEntity> InsertAsync(TEntity entity);

        /// <summary>
        /// ?…?o???????-???“
        /// </summary>
        /// <param name="entities"></param>
        /// <param name="options"></param>
        /// <param name="bulkSize"></param>
        void BulkInsert(IEnumerable<TEntity> entities, SqlBulkCopyOptions options, int? bulkSize=null);

        /// <summary>
        /// ?…?o???????-???“
        /// </summary>
        /// <param name="entities"></param>
        /// <param name="bulkSize"></param>

        void BulkInsert(IEnumerable<TEntity> entities, int? bulkSize=null);
```
##????????
/// <summary>
        /// ???????? ?μ?￥???? ?????2??
        /// </summary>
        /// <param name="entity"></param>
        /// <returns></returns>
        TEntity Update(TEntity entity);

        /// <summary>
        /// ???????? ?μ?￥???????μ???￥ ?’???2??
        /// </summary>
        /// <param name="entity"></param>
        /// <returns></returns>
        Task<TEntity> UpdateAsync(TEntity entity);

         /// <summary>
        /// ?…?o????????????
        /// </summary>
        /// <param name="filter"></param>
        /// <param name="update"></param>
        /// <returns></returns>
        int Update(Expression<Func<TEntity, bool>> filter,Expression<Func<TEntity,TEntity>> update);

        /// <summary>
        /// ?…?o?????????????’???2??
        /// </summary>
        /// <param name="filter"></param>
        /// <param name="update"></param>
        /// <returns></returns>
        Task<int> UpdateAsync(Expression<Func<TEntity, bool>> filter, Expression<Func<TEntity, TEntity>> update);
```
##?‰???3??
```c#
/// <summary>
        /// ?‰???3???μ?￥???????μ???￥
        /// </summary>
        /// <param name="entity"></param>
        void Delete(TEntity entity);
        /// <summary>
        /// ?‰???3???μ?￥???????μ???￥ ?’???2??
        /// </summary>
        /// <param name="entity"></param>
        /// <returns></returns>

        Task DeleteAsync(TEntity entity);
        /// <summary>
        /// ?…?o?????‰???3??
        /// </summary>
        /// <param name="filter"></param>
        /// <returns></returns>
        int Delete(Expression<Func<TEntity, bool>> filter);

        /// <summary>
        /// ?…?o?????‰???3?? ?’???2??
        /// </summary>
        /// <param name="filter"></param>
        /// <returns></returns>
        Task<int> DeleteAsync(Expression<Func<TEntity, bool>> filter);
```


